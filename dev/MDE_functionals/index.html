<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cost Functionals for the MDE · MDE for Multiscale Documentation</title><meta name="title" content="Cost Functionals for the MDE · MDE for Multiscale Documentation"/><meta property="og:title" content="Cost Functionals for the MDE · MDE for Multiscale Documentation"/><meta property="twitter:title" content="Cost Functionals for the MDE · MDE for Multiscale Documentation"/><meta name="description" content="Documentation for MDE for Multiscale Documentation."/><meta property="og:description" content="Documentation for MDE for Multiscale Documentation."/><meta property="twitter:description" content="Documentation for MDE for Multiscale Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MDE for Multiscale Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MDE for Multiscale Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Welcome</a></li><li><a class="tocitem" href="../multiscale_limit_pairs/">Multiscale System and Homogenized Limit Pairs</a></li><li><a class="tocitem" href="../invariant_densities/">Invariant Densities</a></li><li class="is-active"><a class="tocitem" href>Cost Functionals for the MDE</a><ul class="internal"><li><a class="tocitem" href="#Cost-Functionals"><span>Cost Functionals</span></a></li><li><a class="tocitem" href="#Gradients-of-Cost-Functionals"><span>Gradients of Cost Functionals</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="../MDE_optimizers/">Optimization Task of the MDE</a></li><li><a class="tocitem" href="../MDE_asymptotic_variances/">Asymptotic Variances of the MDE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Cost Functionals for the MDE</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cost Functionals for the MDE</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Faik1995/MDE-for-Multiscale" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/main/docs/src/MDE_functionals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Cost-Functionals-for-the-MDE"><a class="docs-heading-anchor" href="#Cost-Functionals-for-the-MDE">Cost Functionals for the MDE</a><a id="Cost-Functionals-for-the-MDE-1"></a><a class="docs-heading-anchor-permalink" href="#Cost-Functionals-for-the-MDE" title="Permalink"></a></h1><p>In its most general form, the cost functional of the MDE is given by</p><p class="math-container">\[\begin{aligned}
    \Delta_T(\vartheta, X_\epsilon) := \int_{\R^d} \left| \frac1T \int_0^T \exp\left(i u^\top X_\epsilon(t)\right) \, dt - \int_{\R^d} \exp\left(i u^\top x\right) \mu(\vartheta, x) \, dx \right|^2 \varphi(u) \, du.
\end{aligned}\]</p><p>Choosing a centered Gaussian density with covariance matrix <span>$\beta^2 I_d, \beta &gt; 0$</span>, for <span>$\varphi$</span> reduces the above formula to</p><p class="math-container">\[\begin{aligned}
    \Delta_T(\vartheta, X_\epsilon) = 
    &amp;\frac{1}{T^2} \int_0^T \int_0^T k(X_\epsilon(t)-X_\epsilon(s)) \, dt \, ds \\[0.25cm]
    &amp;- \frac{2}{T} \int_0^T (\mu(\vartheta) \ast k)(X_\epsilon(t)) \, dt + \int_{\R^d} (\mu(\vartheta) \ast k)(x) \mu(\vartheta, x) \, dx,
\end{aligned}\]</p><p>where <span>$k(x) :=\exp(-\beta^2 |x|_2^2/2)$</span> is the characteristic function of <span>$\varphi$</span> and <span>$\ast$</span> denotes the convolution operator on <span>$\R^d$</span>. Furthermore, if <span>$\mu(\vartheta)$</span> is the density of a centered multivariate normal distribution with a positive definite covariance matrix <span>$M(\vartheta) \in \R^{d \times d}$</span>, then</p><p class="math-container">\[\begin{aligned}
  \Delta_T(\vartheta, X_\epsilon) &amp;= - \frac{2}{T \sqrt{\det(I_d + \beta^2 M(\vartheta)) }} \int_0^T \exp\left( -\frac{\beta^2}{2} X_\epsilon(t)^\top \left( I_d + \beta^2 M(\vartheta) \right)^{-1} X_\epsilon(t) \right) \, dt \\[0.25cm]
    &amp;+ \frac{1}{\sqrt{\det(I_d + 2 \beta^2 M(\vartheta))}}.
\end{aligned}\]</p><h2 id="Cost-Functionals"><a class="docs-heading-anchor" href="#Cost-Functionals">Cost Functionals</a><a id="Cost-Functionals-1"></a><a class="docs-heading-anchor-permalink" href="#Cost-Functionals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.k" href="#MDE_project.k"><code>MDE_project.k</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k(x, β)</code></pre><p>Return <code>β</code> and function value of the characteristic function of a centered Gaussian density with standard deviation <code>β</code> at the point <code>x</code> as a tuple.</p><p>This characteristic function is given by</p><p class="math-container">\[\begin{aligned}
  k_\beta(x) = \exp\left( -\frac{\beta^2 x^2}{2} \right), \quad x \in \R.
\end{aligned}\]</p><p>It is used in the definition of the MDE and thoroughly outlined in the main manuscript in the numerics section.</p><hr/><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>:         argument <span>$x$</span> at which to evaluate the function.</li><li><code>β::Real</code>:         positive number <span>$\beta$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_functionals.jl#L25-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ" href="#MDE_project.Δ"><code>MDE_project.Δ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ(data, ϑ, Σ, V)</code></pre><p>Compute cost functional for given <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code>.</p><p>A properly discretized version of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
  \Delta_T(X_\epsilon, \vartheta, \Sigma, V) = - \frac{2}{T} \int_0^T (\mu(\vartheta, \Sigma, V) \ast k_\beta)(X_\epsilon(t)) \, dt + \int_{\R} (\mu(\vartheta, \Sigma, V) \ast k_\beta)(x) \mu(\vartheta, \Sigma, x) \, dx,
\end{aligned}\]</p><p>is implemented and evaluated via <a href="https://docs.julialang.org/en/v1/manual/multi-threading/">multithreading</a>. Here, <span>$X_ϵ$</span> is a one-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, <span>$\mu$</span> is the invariant density of the homogenized limit SDE, <span>$k_\beta$</span> refers to <a href="#MDE_project.k"><code>k</code></a>, and <span>$\ast$</span> is the convolution operator on <span>$\R$</span>. See the main manuscript for details on this functional. It is the core object of the MDE.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The computational cost of this function is quite high due to the integration of the convolutions, so if the data is finely discretized, then the running times for a single evalutation are relatively long. Remember that, in this case of a  non-quadratic potential, further simplifications of the above formula are not known thus far.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>When comparing the above formula with the formula from the main manuscript, then one notices that the double integral term is missing above.  This is on purpose because the double integral does not depend on any parameters with respect to which we will optimize.</p></div></div><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         one-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Real</code>:                    positive drift coefficient <span>$\vartheta$</span>.</li><li><code>Σ::Real</code>:                    positive diffusion coefficient <span>$\Sigma$</span>.</li><li><code>V</code>:                          defining potential function <span>$V$</span> for the invariant density.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">$ julia --threads 10 --project=. # start julia with 10 threads and activate project</code></pre><pre><code class="language-julia-repl hljs">julia&gt; Threads.nthreads()
julia&gt; using MDE_project
julia&gt; data = Langevin_ϵ(1.0, func_config=NLDO(), α=2.0, σ=1.0, ϵ=0.1, T=100)[1]
julia&gt; Δ(data, 1, 1, NLDO()[1])</code></pre><hr/><p>See also <a href="#MDE_project.Δ_Gaussian1D"><code>Δ_Gaussian1D</code></a>, <a href="#MDE_project.Δ_Gaussian2D"><code>Δ_Gaussian2D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_functionals.jl#L88-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ_Gaussian1D" href="#MDE_project.Δ_Gaussian1D"><code>MDE_project.Δ_Gaussian1D</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ_Gaussian1D(data, ϑ, Σ)</code></pre><p>Compute cost functional for given one-dimensonal <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code> in the case where the invariant density of the homogenized limit SDE is centered Gaussian.</p><p>A properly discretized version of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
  \Delta_T(X_\epsilon, \vartheta, \Sigma, V) = -\frac{2}{T \sqrt{1 + \beta^2 \frac{\Sigma}{\vartheta}} } \int_0^T \exp\left( -\frac{\beta^2 X_\epsilon(t)^2}{2 (1 + \beta^2 \frac{\Sigma}{\vartheta})} \right) \, dt + \frac{1}{\sqrt{1 + 2 \beta^2 \frac{\Sigma}{\vartheta}}},
\end{aligned}\]</p><p>is implemented. Here, <span>$X_ϵ$</span> is a one-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, and <span>$\beta$</span> comes from <a href="#MDE_project.k"><code>k</code></a>. The potential is here <span>$V(x) = x^2/2$</span>. See the main manuscript for details on this functional. It is the core object of the MDE.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The evaluation is, compared to <a href="#MDE_project.Δ"><code>Δ</code></a>, extremely fast, even for finely discretized data, which signifies the utility of choosing a centered Gaussian weight <a href="#MDE_project.k"><code>k</code></a> in this Gaussian case.</p></div></div><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         one-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Real</code>:                    positive drift coefficient <span>$\vartheta$</span>.</li><li><code>Σ::Real</code>:                    positive diffusion coefficient <span>$\Sigma$</span>.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MDE_project
julia&gt; data = Langevin_ϵ(1.0, func_config=LDO(), α=2.0, σ=1.0, ϵ=0.1, T=100)[1]
julia&gt; Δ_Gaussian1D(data, 1, 1)</code></pre><hr/><p>See also <a href="#MDE_project.Δ"><code>Δ</code></a>, <a href="#MDE_project.Δ_Gaussian2D"><code>Δ_Gaussian2D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_functionals.jl#L143-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ_Gaussian2D" href="#MDE_project.Δ_Gaussian2D"><code>MDE_project.Δ_Gaussian2D</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ_Gaussian2D(data, ϑ, Σ)</code></pre><p>Compute cost functional for given two-dimensonal <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code> in the case where the invariant density of the homogenized limit SDE is centered Gaussian.</p><p>A properly discretized version of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
  \Delta_T(X_\epsilon, \vartheta, \Sigma) &amp;= - \frac{2}{T \sqrt{\det(I_d + \beta^2 M(\vartheta, \Sigma)) }} \int_0^T \exp\left( -\frac{\beta^2}{2} X_\epsilon(t)^\top \left( I_d + \beta^2 M(\vartheta, \Sigma) \right)^{-1} X_\epsilon(t) \right) \, dt \\[0.25cm]
    &amp;+ \frac{1}{\sqrt{\det(I_d + 2 \beta^2 M(\vartheta, \Sigma))}},
\end{aligned}\]</p><p>is implemented. Here, <span>$X_ϵ$</span> is a two-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, <span>$M(\vartheta, \Sigma) \in \R^{2 \times 2}$</span> is a matrix depending on <span>$\vartheta$</span> and <span>$\Sigma$</span> and is given by the covariance matrix of the invariant Gaussian density, and <span>$\beta$</span> comes from <a href="#MDE_project.k"><code>k</code></a>. See the main manuscript for details on this functional and the appearing quantities. It is the core object of the MDE.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The evaluation is, compared to <a href="#MDE_project.Δ"><code>Δ</code></a>, extremely fast, even for finely discretized two-dimensional data, which signifies the utility of choosing a two-dimensional centered Gaussian weight <a href="#MDE_project.k"><code>k</code></a> in this Gaussian case.</p></div></div><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         two-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Array{Real}</code>:             positive definite drift matrix <span>$\vartheta \in \mathbb{R}^{2 \times 2}$</span>.</li><li><code>Σ::Array{Real}</code>:             positive definite diffusion matrix <span>$\Sigma \in \mathbb{R}^{2 \times 2}$</span>.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MDE_project
julia&gt; M=[4 2;2 3]
julia&gt; σ = 5.0  
julia&gt; data = Langevin_ϵ_2D([-5.0, -5.0], func_config=(x-&gt; cos(x), x -&gt; 1/2*cos(x)), M=M, σ=σ, ϵ=0.1, T=100.0)[1]
julia&gt; CorrK = [K(x-&gt; cos(x), σ) 0 ; 0 K(x -&gt; 1/2*cos(x), σ)]
julia&gt; ϑ = CorrK*M
julia&gt; Σ = σ*CorrK
julia&gt; Δ_Gaussian2D(data, ϑ, Σ)</code></pre><hr/><p>See also <a href="#MDE_project.Δ"><code>Δ</code></a>, <a href="#MDE_project.Δ_Gaussian1D"><code>Δ_Gaussian1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_functionals.jl#L216-L256">source</a></section></article><h2 id="Gradients-of-Cost-Functionals"><a class="docs-heading-anchor" href="#Gradients-of-Cost-Functionals">Gradients of Cost Functionals</a><a id="Gradients-of-Cost-Functionals-1"></a><a class="docs-heading-anchor-permalink" href="#Gradients-of-Cost-Functionals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ_grad_ϑ" href="#MDE_project.Δ_grad_ϑ"><code>MDE_project.Δ_grad_ϑ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ_grad_ϑ(data, ϑ, Σ, V)</code></pre><p>Compute gradient of cost functional <a href="#MDE_project.Δ"><code>Δ</code></a> with respect to <code>ϑ</code> for given <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code> and a potential <code>V</code>.</p><p>A properly discretized version of the gradient of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
  \partial_\vartheta \Delta_T(X_\epsilon, \vartheta, \Sigma, V) = -\frac{2}{T} \int_0^T (\partial_\vartheta \mu(\vartheta, \Sigma, V) \ast k_\beta)(X_\epsilon(t)) \, dt + 2 \int_{\R} (\mu(\vartheta, \Sigma, V) \ast k_\beta)(x) \partial_\vartheta \mu(\vartheta, \Sigma, x) \, dx,
\end{aligned}\]</p><p>is implemented and evaluated via <a href="https://docs.julialang.org/en/v1/manual/multi-threading/">multithreading</a>. Here, <span>$X_ϵ$</span> is a one-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, <span>$\mu$</span> is the invariant density of the homogenized limit SDE corresponding to <a href="../invariant_densities/#MDE_project.μ"><code>μ</code></a>, <span>$k_\beta$</span> refers to <a href="#MDE_project.k"><code>k</code></a>, and <span>$\ast$</span> is the convolution operator on <span>$\R$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The computational cost of this function is quite high due to the integration of the convolutions, so if the data is finely discretized, then the running times for a single evalutation are relatively long. Remember that, in this case of a  non-quadratic potential, further simplifications of the above formula are not known thus far.</p></div></div><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         one-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Real</code>:                    drift coefficient <span>$\vartheta$</span>.</li><li><code>Σ::Real</code>:                    positive diffusion coefficient <span>$\Sigma$</span>.</li><li><code>V</code>:                          defining potential function <span>$V$</span> for the invariant density.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">$ julia --threads 10 --project=. # start julia with 10 threads and activate project</code></pre><pre><code class="language-julia-repl hljs">julia&gt; Threads.nthreads()
julia&gt; using MDE_project
julia&gt; data = Langevin_ϵ(1.0, func_config=NLDO(), α=2.0, σ=1.0, ϵ=0.1, T=100)[1]
julia&gt; Δ_grad_ϑ(data, 1, 1, NLDO()[1])</code></pre><hr/><p>See also <a href="#MDE_project.Δ"><code>Δ</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_gradients.jl#L57-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ_grad_Σ" href="#MDE_project.Δ_grad_Σ"><code>MDE_project.Δ_grad_Σ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ_grad_Σ(data, ϑ, Σ, V)</code></pre><p>Compute gradient of cost functional <a href="#MDE_project.Δ"><code>Δ</code></a> with respect to <code>Σ</code> for given <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code> and a potential <code>V</code>.</p><p>A properly discretized version of the gradient of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
  \partial_\Sigma \Delta_T(X_\epsilon, \vartheta, \Sigma, V) = -\frac{2}{T} \int_0^T (\partial_\Sigma \mu(\vartheta, \Sigma, V) \ast k_\beta)(X_\epsilon(t)) \, dt + 2 \int_{\R} (\mu(\vartheta, \Sigma, V) \ast k_\beta)(x) \partial_\Sigma \mu(\vartheta, \Sigma, x) \, dx,
\end{aligned}\]</p><p>is implemented and evaluated via <a href="https://docs.julialang.org/en/v1/manual/multi-threading/">multithreading</a>. Here, <span>$X_ϵ$</span> is a one-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, <span>$\mu$</span> is the invariant density of the homogenized limit SDE corresponding to <a href="../invariant_densities/#MDE_project.μ"><code>μ</code></a>, <span>$k_\beta$</span> refers to <a href="#MDE_project.k"><code>k</code></a>, and <span>$\ast$</span> is the convolution operator on <span>$\R$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The computational cost of this function is quite high due to the integration of the convolutions, so if the data is finely discretized, then the running times for a single evalutation are relatively long. Remember that, in this case of a  non-quadratic potential, further simplifications of the above formula are not known thus far.</p></div></div><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         one-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Real</code>:                    drift coefficient <span>$\vartheta$</span>.</li><li><code>Σ::Real</code>:                    positive diffusion coefficient <span>$\Sigma$</span>.</li><li><code>V</code>:                          defining potential function <span>$V$</span> for the invariant density.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">$ julia --threads 10 --project=. # start julia with 10 threads and activate project</code></pre><pre><code class="language-julia-repl hljs">julia&gt; Threads.nthreads()
julia&gt; using MDE_project
julia&gt; data = Langevin_ϵ(1.0, func_config=NLDO(), α=2.0, σ=1.0, ϵ=0.1, T=100)[1]
julia&gt; Δ_grad_Σ(data, 1, 1, NLDO()[1])</code></pre><hr/><p>See also <a href="#MDE_project.Δ"><code>Δ</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_gradients.jl#L146-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MDE_project.Δ_Gaussian1D_grad" href="#MDE_project.Δ_Gaussian1D_grad"><code>MDE_project.Δ_Gaussian1D_grad</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Δ_Gaussian1D_grad(data, ϑ, Σ)</code></pre><p>Compute gradient of cost functional <a href="#MDE_project.Δ_Gaussian1D"><code>Δ_Gaussian1D</code></a> for given one-dimensonal <code>data</code> and parameter values <code>ϑ</code> and <code>Σ</code>.</p><p>A properly discretized version of the gradient of the cost functional, given by</p><p class="math-container">\[\begin{aligned}
    \partial_\vartheta \Delta_T(X_\epsilon, \vartheta, \Sigma, V) 
    = &amp;\frac{\beta^2 \Sigma}{T \left( 1 + \beta^2 \frac{\Sigma}{\vartheta} \right)^{5/2} \vartheta^3} \int_0^T \left[ \left( X_\epsilon(t)^2 \beta^2 - 1 \right)\vartheta - \beta^2 \Sigma \right] \exp\left( -\frac{\beta^2 X_\epsilon(t)^2}{2 (1 + \beta^2 \frac{\Sigma}{\vartheta})} \right) \, dt \\[0.25cm]
    &amp;+ \frac{\beta^2 \Sigma}{\left( 1 + 2 \beta^2 \frac{\Sigma}{\vartheta} \right)^{3/2} \vartheta^2}.
\end{aligned}\]</p><p>is implemented. Here, <span>$X_ϵ$</span> is a one-dimensional time series of length <span>$T$</span>, obtained from a multiscale SDE, and <span>$\beta$</span> comes from <a href="#MDE_project.k"><code>k</code></a>. The potential is here <span>$V(x) = x^2/2$</span>. </p><hr/><p><strong>Arguments</strong></p><ul><li><code>data::Vector{Real}</code>:         one-dimensional time series <span>$X_ϵ$</span>.</li><li><code>ϑ::Real</code>:                    drift coefficient <span>$\vartheta$</span>.</li><li><code>Σ::Real</code>:                    positive diffusion coefficient <span>$\Sigma$</span>.</li></ul><hr/><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MDE_project
julia&gt; data = Langevin_ϵ(1.0, func_config=LDO(), α=2.0, σ=1.0, ϵ=0.1, T=100)[1]
julia&gt; Δ_Gaussian1D_grad(data, 1, 1)</code></pre><hr/><p>See also <a href="#MDE_project.Δ_Gaussian1D"><code>Δ_Gaussian1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Faik1995/MDE-for-Multiscale/blob/f7405347dc4288ca37c5ee0ceb19d8dcc369d74d/src/MDE_gradients.jl#L195-L226">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#MDE_project.k"><code>MDE_project.k</code></a></li><li><a href="#MDE_project.Δ"><code>MDE_project.Δ</code></a></li><li><a href="#MDE_project.Δ_Gaussian1D"><code>MDE_project.Δ_Gaussian1D</code></a></li><li><a href="#MDE_project.Δ_Gaussian1D_grad"><code>MDE_project.Δ_Gaussian1D_grad</code></a></li><li><a href="#MDE_project.Δ_Gaussian2D"><code>MDE_project.Δ_Gaussian2D</code></a></li><li><a href="#MDE_project.Δ_grad_Σ"><code>MDE_project.Δ_grad_Σ</code></a></li><li><a href="#MDE_project.Δ_grad_ϑ"><code>MDE_project.Δ_grad_ϑ</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../invariant_densities/">« Invariant Densities</a><a class="docs-footer-nextpage" href="../MDE_optimizers/">Optimization Task of the MDE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Friday 30 August 2024 12:03">Friday 30 August 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
